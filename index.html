<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Ä°ngilizce CÃ¼mle Ã‡alÄ±ÅŸma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .card {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .level { font-size: 14px; color: #666; margin-bottom: 10px; }
    #sentence {
      font-size: 20px;
      margin: 20px 0;
      line-height: 1.5;
    }
    .word {
      cursor: pointer;
      padding: 2px 4px;
      border-radius: 4px;
      transition: background 0.2s;
    }
    .word:hover { background: #e0f7fa; }
    #translation-popup {
      position: absolute;
      background: #333;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 14px;
      pointer-events: none;
      z-index: 100;
      max-width: 300px;
      display: none;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin: 15px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
    }
    #new-btn { background: #007bff; color: white; }
    #check-btn { background: #28a745; color: white; }
    #result {
      font-size: 18px;
      font-weight: bold;
      margin-top: 15px;
      min-height: 30px;
    }
    .correct { color: #28a745; }
    .wrong { color: #dc3545; }
  </style>
</head>
<body>

<div class="card">
  <div class="level" id="level">Seviye</div>
  <div id="sentence">Butona bas</div>
  <div id="translation-popup"></div>

  <textarea id="user-translation" placeholder="Buraya TÃ¼rkÃ§e Ã§evirini yaz..." rows="3"></textarea>
  
  <button id="new-btn" onclick="newSentence()">Yeni CÃ¼mle</button>
  <button id="check-btn" onclick="checkTranslation()">Kontrol Et</button>
  
  <div id="result"></div>
</div>

<script>
// LibreTranslate public instance (Ã¼cretsiz, rate limit olabilir)
// Alternatif: https://libretranslate.de/translate
const TRANSLATE_API = 'https://translate.argosopentech.com/translate';

const sentences = [
  { text: "I started learning English last year.", level: "A2", tr: "GeÃ§en yÄ±l Ä°ngilizce Ã¶ÄŸrenmeye baÅŸladÄ±m." },
  { text: "She usually studies at night.", level: "A2", tr: "O genellikle gece Ã§alÄ±ÅŸÄ±r." },
  // ... diÄŸer cÃ¼mlelerini buraya ekle, her birine "tr": "Ã§eviri" ekle
  // Ã–rnek olarak 5 tane ekledim, sen hepsini doldurabilirsin veya boÅŸ bÄ±rakÄ±p manuel yazdÄ±rabilirsin
  { text: "They moved to a new city recently.", level: "A2", tr: "YakÄ±n zamanda yeni bir ÅŸehre taÅŸÄ±ndÄ±lar." },
  { text: "He forgot to bring his keys.", level: "A2", tr: "AnahtarlarÄ±nÄ± getirmeyi unuttu." },
  { text: "We met by chance at the airport.", level: "A2", tr: "HavalimanÄ±nda tesadÃ¼fen karÅŸÄ±laÅŸtÄ±k." },
  // Tam listeni buraya kopyala, her objeye tr: "..." ekle
  // EÄŸer Ã§eviri yoksa boÅŸ bÄ±rak: tr: ""
];

let currentSentence = null;

function newSentence() {
  const random = Math.floor(Math.random() * sentences.length);
  currentSentence = sentences[random];
  
  document.getElementById("level").innerText = "Seviye: " + currentSentence.level;
  document.getElementById("user-translation").value = "";
  document.getElementById("result").innerText = "";
  
  // CÃ¼mleyi kelime kelime tÄ±klanabilir yap
  const words = currentSentence.text.split(/\s+/);
  let html = '';
  words.forEach(word => {
    // Noktalama temizle ama kelimeyi koru
    const cleanWord = word.replace(/[.,!?;:'"()]/g, '');
    html += `<span class="word" onclick="showWordTranslation('${cleanWord}')">${word} </span>`;
  });
  document.getElementById("sentence").innerHTML = html.trim();
}

async function showWordTranslation(word) {
  if (!word) return;
  
  try {
    const response = await fetch(TRANSLATE_API, {
      method: 'POST',
      body: JSON.stringify({
        q: word,
        source: 'en',
        target: 'tr',
        format: 'text'
      }),
      headers: { 'Content-Type': 'application/json' }
    });
    const data = await response.json();
    const translation = data.translatedText || 'Ã‡eviri bulunamadÄ±';
    
    const popup = document.getElementById("translation-popup");
    popup.innerText = `${word} â†’ ${translation}`;
    popup.style.display = 'block';
    
    // Fareyi kelimeden Ã§ekince gizle
    setTimeout(() => { popup.style.display = 'none'; }, 3000);
  } catch (err) {
    console.error(err);
    alert('Kelime Ã§evirisi alÄ±namadÄ± (API sorunu olabilir).');
  }
}

function checkTranslation() {
  if (!currentSentence) return;
  
  const userText = document.getElementById("user-translation").value.trim().toLowerCase();
  const correctText = (currentSentence.tr || "").trim().toLowerCase();
  
  const resultEl = document.getElementById("result");
  
  if (userText === correctText && correctText !== "") {
    resultEl.innerText = "DoÄŸru! ðŸŽ‰";
    resultEl.className = "correct";
  } else if (correctText === "") {
    resultEl.innerText = "Bu cÃ¼mlenin Ã§evirisi henÃ¼z eklenmemiÅŸ.";
    resultEl.className = "";
  } else {
    resultEl.innerText = `YanlÄ±ÅŸ. DoÄŸru cevap: ${currentSentence.tr}`;
    resultEl.className = "wrong";
  }
}

// Sayfa yÃ¼klenince ilk cÃ¼mleyi gÃ¶ster
window.onload = newSentence;
</script>

</body>
</html>
